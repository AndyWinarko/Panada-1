<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
    <title>Panada PHP Framework 0.3.1 Documentation - Database Abstraction</title>
    <link rel="stylesheet" href="../../../style.css" type="text/css" media="screen" />
</head>
<body>
    <div class="header">
    <span class="logo"><a target="_blank" href="http://panadaframework.com">Panada</a></span>
        <div class="menu">
            <form action="http://www.google.com/search" method="get">
	    <input type="hidden" value="panadaframework.com/documentation/" id="as_sitesearch" name="as_sitesearch">
            <input class="search-input" type="text" name="q" /><button class="search-button" type="submit">Search</button>
            </form>
        </div>
    </div>
    
    <div class="subheader">
        <h1>Panada Framework 0.3.1 Documentation</h1>
    </div>
    
    <div class="wrapper">
        <div class="sidebar">
            <div class="navigation">
                <ul>
                    <li>
                        <a href="../index.html">Umum</a>
                        <ul>
                            <li><a href="../../index.html#about">Tentang Panada</a></li>
                            <li><a href="../../index.html#feature">Keunggulan (<em>Feature</em>)</a></li>
                            <li><a href="../../index.html#license">Lisensi</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="../../config.html">Konfigurasi</a>
                        <ul>
                            <li><a href="../../config.html#general">Dasar</a></li>
                            <li><a href="../../config.html#additional_config">Tambahan</a></li>
                            <li><a href="../../config.html#webserver">Webserver</a></li>
                        </ul>
                    </li>
                    <li>
                        Referensi
                        <ul>
                            <li><a href="../../references/controller.html">Controller</a></li>
                            <li><a href="../../references/model.html">Model</a></li>
                            <li><a href="../../references/view.html">View</a></li>
                            <li><a href="../../references/library.html">Library</a></li>
                            <li><a href="../../references/autoloader.html">Auto Loader</a></li>
                            <li><a href="../../references/global_method.html">Global Method dan Properties</a></li>
                        </ul>
                            
                    </li>
                    <li>
                        <a href="../index.html">Paket Library</a>
                        <ul>
                            <li>
				<a href="index.html">Database</a>
				<ul>
				    <li><a href="index.html">Configuration</a></li>
                                    <li><a href="query_builder.html">Query Builder</a></li>
				    <li><a href="activerecord.html">Active Record</a></li>
					<ul>
					    <li><a href="#init">Inisialisasi</a></li>
					    <li><a href="#crud">Basic CRUD</a></li>
					</ul>
                                    <li><a href="manual_query.html">Manual Query</a></li>
				</ul>
			    </li>
                            <li><a href="../session.html">Session</a></li>
                            <li><a href="../pagination.html">Pagination</a></li>
                            <li><a href="../email.html">Email</a></li>
                            <li><a href="../encryption.html">Encryption</a></li>
                            <li><a href="../upload.html">Upload</a></li>
                            <li><a href="../image.html">Image</a></li>
                            <li><a href="../request.html">Request</a></li>
                            <li><a href="../rest.html">RESTfull</a></li>
			    <li><a href="../memcached.html">Memcached</a></li>
                            <li><a href="../mongodb.html">Mongodb</a></li>
                            <li><a href="../apc.html">APC</a></li>
			    <li><a href="../tools.html">Tools</a></li>
                        </ul>
                    </li>
                    <li><a href="../../contribution.html">Kontribusi</a></li>
                    <li><a href="../../credit.html">Credit</a></li>
                </ul>
	    </div>
            
        </div>
        
        <div class="content">
            <div class="lead">
                <h2>Active Record</h2>
                <p>Panada mengikuti <em>pattern</em> Active Record sebagaimana yang terdapat di <a target="_blank" href="http://en.wikipedia.org/wiki/Active_record_pattern">http://en.wikipedia.org/wiki/Active_record_pattern</a>. Setiap nama tabel diwakili oleh sebuah class dan setiap properties class mewakili nama kolom.</p>
            </div>
	    
	    <div class="main">
		<h3 id="init">Inisialisasi</h3>
		<h4>Class Model</h4>
		<p>Untuk menggunakan Active Record Anda harus membuat sebuah class model yang di extend ke library <strong>Library_active_record</strong>. Setiap class yang dibuat mewakili sebuah tabel yang ada di database. Berikut adalah contoh model dari tabel <strong>posts</strong>:</p>
<textarea rows="10" cols="50" class="textarea">
&lt;?php
class Model_posts extends Library_active_record {
    
    public function __construct(){
        
        call_user_func_array( 'parent::__construct', func_get_args() );
        
    }
}
</textarea>
		<h4>Nama Tabel</h4>
		<p>Secara default, nama tabel yang akan digunakan mengikuti nama class model tanpa prefix <strong>Model_</strong>. Sebagai contoh jika nama classnya adalah <strong>Model_users</strong>, maka nama tabel yang diwakili adalah <strong>users</strong> dan jika nama modelnya adalah <strong>Model_comments</strong> maka class ini mewakili tabel <strong>comments</strong>.</p>
		<p>Namun Anda juga bisa menentukan nama lain yang tidak sama dengan nama class. Untuk melakukan hal ini Anda bisa mendeklarasikannya di properti <strong>$this->table</strong>. Berikut adalah contohnya:</p>
<textarea rows="12" cols="50" class="textarea">
&lt;?php
class Model_posts extends Library_active_record {
    
    public function __construct(){
        
        call_user_func_array( 'parent::__construct', func_get_args() );
	
	$this->table = 'dbconnection2';
        
    }
}
</textarea>		
		<h4>Primary Key</h4>
		<p>Setiap class model membutuhkan properti <strong>primary_key</strong>. Secara default Panada menggunakan nama <strong>$this->primary_key</strong>, namun Anda bisa menggunakan nama lain untuk konfigurasi ini. Berikut adalah contoh mendefenisikan nama primary key sesuai dengan nama yang ada di tabel:</p>
<textarea rows="12" cols="50" class="textarea">
&lt;?php
class Model_posts extends Library_active_record {
    
    public function __construct(){
        
	$this->primary_key = 'table_key';
	
        call_user_func_array( 'parent::__construct', func_get_args() );
        
    }
}
</textarea>		
		<h4>Koneksi</h4>
		<p>Jika Anda memiliki <a href="index.html#config">koneksi database</a> lebih dari satu dan ingin menggunakan koneksi tersebut pada class model ini, Anda bisa menggunakannya dengan memberikan nama koneksinya pada properti <strong>$this->connection</strong>. Berikut adalah contohnya:</p>
<textarea rows="12" cols="50" class="textarea">
&lt;?php
class Model_posts extends Library_active_record {
    
    public function __construct(){
        
	$this->connection = 'db_second_connection';
	
        call_user_func_array( 'parent::__construct', func_get_args() );
        
    }
}
</textarea>		
	    </div>
	    <div class="main">
		<h3 id="use">Penggunaan</h3>
		<p>Sebelum proses manipulasi database dilakukan, Anda harus mendeklarasikan <em>instance</em> class yang namanya sesuai dengan nama tabel dengan diawali prefix <strong>Model_</strong>.</p>
		
<textarea rows="15" cols="50" class="textarea">
&lt;?php
class Controller_home extends Panada {
    
    public function __construct(){
        
        parent::__construct();
    }
    
    public function index(){
        
	// Tabel users
        $users = new Model_users();
    }
}
</textarea>
		<p>Jika memiliki koneksi database yang lain, argument pertama dengan tipe data <strong>string</strong> bisa diisikan dengan nama koneksinya. Lihat halaman <a href="index.html">Konfigurasi Database</a> untuk menentukan nama koneksi.</p>
		<code>
		    $users = new Model_users( '<strong>dbconnection2</strong>' );
		</code>
	    </div>
	    
	    <div class="main">
		<h3 id="crud">Basic CRUD</h3>
		<p>Berikut adalah contoh penggunaan dasar create, read, update dan delete (CRUD):</p>
		
		<h4>Create</h4>
		<p>Untuk menyimpan data baru ada dua cara yang bisa dilakukan. Cara pertama:</p>
<textarea rows="6" cols="50" class="textarea">
$users = new AR_users();
$users->name = 'Budi';
$users->email = 'budi@budi.com';
$users->password = 'mypassword';
$users->save();
</textarea>
		<p>Atau dengan cara yang lebih cepat:</p>
		<code>
		    $users = new AR_users( array('name' => 'Budi', 'email' => 'budi@budi.com', 'password' => 'mypassword') );
		</code>
		<p>Kedua cara di atas merepresentasikan SQL:</p>
		<code>
		    INSERT INTO users (name, email, password) VALUES ('Budi', 'budi@budi.com', 'mypassword') 
		</code>
		<p>Jika argument pertama berupa <strong>array</strong>, maka jika diinginkan argument ke dua bisa diisikan nama koneksi database yang digunakan.</p>
		<code>
		    $users = new AR_users( array('name' => 'Budi', 'email' => 'budi@budi.com', 'password' => 'mypassword'), <strong>'dbconnection2'</strong> );
		</code>
		
		<h4>Read</h4>
		<p>Untuk mendapatkan data dengan <strong>id 28</strong>, bisa dilakukan dengan cara:</p>
		<code>
		    $users = new AR_users();<br />
		    print_r( $users->find(28) );
		</code>
		<p>Method ini merepresentasikan output SQL:</p>
		<code>
		    SELECT * FROM users WHERE id = 28
		</code>
		<p>Atau jika ingin mendapatkan beberapa data sekaligus:</p>
		<code>
		    $users = new AR_users();<br />
		    print_r( $users->find(1,2,3) );
		</code>
		<p>Method ini merepresentasikan output SQL:</p>
		<code>
		    SELECT * FROM users WHERE id IN (1, 2, 3)
		</code>
		<p>Mendapatkan record pertama dari tabel:</p>
		<code>
		    $users = new AR_users();<br />
		    print_r( $users-><strong>first()</strong> );
		</code>
		<p>Method ini merepresentasikan output SQL:</p>
		<code>
		    SELECT * FROM users ORDER BY id ASC LIMIT 1
		</code>
		<p>Mendapatkan record terakhir dari tabel:</p>
		<code>
		    $users = new AR_users();<br />
		    print_r( $users-><strong>last()</strong> );
		</code>
		<p>Method ini merepresentasikan output SQL:</p>
		<code>
		    SELECT * FROM users ORDER BY id DESC LIMIT 1
		</code>
		
		<p>Cara lainnya adalah menggunakan <strong>Dynamic Finder</strong>. Cara ini ditujukan untuk mendapatkan record berdasarkan nama kolom tertentu.</p>
		<p>Gunakan method <strong>find_by_</strong> dan dikuti dengan <strong>nama_colom</strong> yang akan dijadikan kriteria. Berikut adalah contohnya:</p>

<textarea rows="11" cols="50" class="textarea">
    $users = new AR_users();
    
    print_r( $users->find_by_email( 'foo@fooweb.com' ) );
    //SELECT * FROM users WEHRE email = 'foo@fooweb.com'
    
    print_r( $users->find_by_name( 'Rasmus Lerdorf' ) );
    //SELECT * FROM users WEHRE title = 'Rasmus Lerdorf'
    
    print_r( $users->find_by_category_id( 5 ) );
    //SELECT * FROM users WEHRE category_id = 5
</textarea>
		<p>Jika data yang ditemukan hanya satu, maka nilai returnnya hanya sebuah object tunggal. Dan jika lebih dari satu, maka nilai returnya terdiri dari beberapa array object.</p>
		
		<h4>Update</h4>
		<p>Untuk memperbaharui data dengan <strong>id 28</strong> caranya adalah:</p>
<textarea rows="6" cols="50" class="textarea">
$users = new AR_users();
$users->find(28);
$users->name = 'Jhon Budi';
$users->password = 'mynewpassword';
$users->save();
</textarea>
		<p>Method ini merepresentasikan output SQL:</p>
		<code>
		    UPDATE users SET name = 'Jhon Budi', password = 'mynewpassword' WHERE id =28
		</code>
		<h4>Delete</h4>
		<p>Berikut adalah cara untuk menghapus data dengan <strong>id 28</strong>:</p>
		<code>
		    $users = new AR_users();<br />
		    $users->delete(28);
		</code>
		<p>Method ini merepresentasikan output SQL:</p>
		<code>
		    DELETE FROM table_name WHERE id = 28
		</code>
	    </div>
	    
	    <div class="main">
		<h3 id="relational_ar">Relational Active Record</h3>
		<p>Panada Active Record juga mendukung <strong>Object Relasional</strong>. Tipe relasional yang sudah didukung adalah <a href="#belongs_to">BELONGS_TO</a></a>, <a href="#has_one">HAS_ONE</a>, <a href="#has_many">HAS_MANY</a> dan <a href="has_many">MANY_MANY</a>. Object Relasional digunakan untuk melakukan relasi tabel database antara satu model dengan model lainnya.</p>
		<p>Untuk melakukan konfigurasi relasi, Anda harus membuat sebuah method bernama <strong>relations()</strong> di dalam class model dengan isi seperti berikut:</p>
<textarea rows="17" cols="50" class="textarea">
&lt;?php
class Model_posts extends Library_active_record {
    
    public function __construct(){
        
        call_user_func_array( 'parent::__construct', func_get_args() );
        
    }
    
    public function relations(){
        
        return array(
            'author' => array(self::BELONGS_TO, 'users', 'post_author')
        );
    }
}
</textarea>
		<p>Dimana nilai array yang harus diisikan adalah:</p>
		<code>
		    return array( <strong>string</strong> 'nama_properti' => array( <strong>contant</strong> self::TIPE_RELASI, <strong>string</strong> 'nama_model', <strong>string</strong> 'foreign_key' ) );
		</code>

		<h4 id="belongs_to">Belongs To</h4>
		<p>Relasi BELONGS_TO menunjukan relasi sebuah model yang memiliki nilai satu atau lebih terhadap sebuah model lain yang memiliki satu nilai. Contoh relasi ini adalah tabel <strong>posts</strong> yang dimiliki oleh satu orang penulis yang ada di tabel <strong>users</strong>.</p>
		<h4 id="has_one">Has One</h4>
		<h4 id="hay_many">Has Many</h4>
		<h4 id="many_many">Many Many</h4>
		
	    </div>
	    
	    <div id="discussion" class="main">
		<h3>Diskusi</h3>
		<div id="disqus_thread"></div>
	    </div>
        
        </div>
        
    </div>
          
    <div class="footer">
        <span class="right">All Rights Reserved.</span>
    </div>
    <script type="text/javascript">
	var disqus_shortname = 'panada';
	var disqus_url = 'http://panadaframework.com/documentation/id/classes/database/activerecord.html';
	var disqus_identifier = disqus_url;
	(function() {
	    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
	    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</body>
</html>